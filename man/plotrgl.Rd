% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualise_rgl.R
\name{plotrgl}
\alias{plotrgl}
\title{Plot atoms and bonds in 3D with rgl}
\usage{
plotrgl(
  atoms,
  bonds,
  col_bond_origin = "origin",
  col_bond_target = "target",
  col_atom_id = "eleno",
  col_atom_name = "elena",
  highlight = NULL,
  highlight_colour = "pink",
  col_atom_colour = col_atom_name,
  clear_scene = TRUE,
  colour_map_atom = pal_atoms(),
  missing = "grey",
  strip_numbers = TRUE,
  bond_width = 2,
  axes = TRUE,
  colour_bg = "black",
  colour_axis = "red",
  label_mode = c("none", "no_atoms", "transparent"),
  col_label = col_atom_name,
  label_cex = 1,
  label_colour = "#F0F8E6",
  atom_alpha = 1,
  atom_alpha_when_labelled = 0.1,
  atom_radius = 0.3,
  atom_shininess = 100,
  bond_alpha = 1,
  grid = FALSE,
  grid_n = 10,
  aspect = c(1, 1, 1)
)
}
\arguments{
\item{atoms}{Data frame of atoms with numeric columns \code{x}, \code{y}, \code{z}, an ID
column (named by \code{col_atom_id}), and a name/element column (named by
\code{col_atom_name}).}

\item{bonds}{Data frame of bonds with two columns that reference atom IDs:
origin (named by \code{col_bond_origin}) and target (named by \code{col_bond_target}).}

\item{col_bond_origin}{Name of column in bonds datatframe describing the atom_id of the first element involved in bond}

\item{col_bond_target}{Name of column in bonds datatframe describing the atom_id of the second element involved in bond}

\item{col_atom_id}{Character scalar naming the atom ID column in \code{atoms}.}

\item{col_atom_name}{Character scalar naming the atom element/name column
in \code{atoms}.}

\item{highlight}{Optional selection of atoms to highlight. Supply values of
\code{col_atom_id} (e.g., numeric IDs) or a logical vector aligned with \code{atoms}.
When provided, these atoms are colored using \code{highlight_colour}.}

\item{highlight_colour}{Single color used for atoms in \code{highlight}; overrides
the normal color mapping for those atoms (default: \code{"pink"}).}

\item{col_atom_colour}{Column name (in \code{atoms}) or a vector used to assign
atom colors. Defaults to \code{col_atom_name}, which is mapped via
\code{colour_map_atom}.}

\item{clear_scene}{Logical; if \code{TRUE}, clears the existing rgl scene first.}

\item{colour_map_atom}{Named character vector mapping element/name → color
(e.g., Jmol-style colors). Used by \code{prepare_atoms_for_plotting()}.}

\item{missing}{Color to use for atoms not found in \code{colour_map_atom}.}

\item{strip_numbers}{Logical; if \code{TRUE}, digits are stripped from the
\code{col_atom_name} values before color lookup (useful for labels like \code{"C12"} → \code{"C"}).}

\item{bond_width}{Numeric line width for bonds.}

\item{axes}{Logical; draw labeled axes box if \code{TRUE}.}

\item{colour_bg}{Colour of scene background}

\item{colour_axis}{Axis and label color.}

\item{label_mode}{One of \code{c("none", "no_atoms", "transparent")}. Controls
how labels and atoms are displayed:
\itemize{
\item \code{"none"}: draw atoms (opaque by default) and no labels;
\item \code{"no_atoms"}: draw only labels (no atom spheres);
\item \code{"transparent"}: draw labels and semi-transparent atoms (see
\code{atom_alpha_when_labelled} and \code{atom_shininess}).
}}

\item{col_label}{Column name (in \code{atoms}) whose values are shown as labels
when \code{label_mode != "none"}. Defaults to \code{col_atom_name}.}

\item{label_cex}{Label character expansion value.}

\item{label_colour}{colour of atom labels}

\item{atom_alpha}{Atom opacity when \code{label_mode} is not \code{"transparent"}.}

\item{atom_alpha_when_labelled}{Atom opacity used when \code{label_mode = "transparent"}.}

\item{atom_radius}{Sphere radius used for atoms.}

\item{atom_shininess}{Numeric shininess for atom spheres; forcibly set to \code{0} for a
flat (non-specular) look when \code{label_mode = "transparent"}.}

\item{bond_alpha}{Opacity of bond segments.}

\item{grid}{Logical; draw orthogonal reference grids if \code{TRUE}.}

\item{grid_n}{Integer; number of grid lines per drawn axis when \code{grid = TRUE}.}

\item{aspect}{Numeric length-3 vector for aspect ratio (currently not used).}
}
\value{
(Invisibly) a list with two elements:
\describe{
\item{atoms}{Vector of RGL object IDs for atom spheres (or \code{NULL} if none).}
\item{bonds}{Vector of RGL object IDs for bond segments.}
}
}
\description{
Renders a ball–stick scene from atom and bond tables using \strong{rgl}.
Each atom is drawn as a sphere and each bond as a segment connecting
referenced atom coordinates. Labels can be drawn with different display
modes via \code{label_mode}.
}
\details{
Bonds are enriched with atom coordinates via
\code{enrich_bonds_with_xyz_position()} and converted to an interleaved start/end
format by \code{to_interleaved()} (columns \verb{x,y,z} and \verb{xend,yend,zend} become
alternating rows suitable for \code{\link[rgl:primitives]{rgl::segments3d()}}).

Labels are drawn at the atom coordinates using \code{\link[rgl:texts]{rgl::texts3d()}}. Depth test
is disabled for labels to ensure visibility over spheres (see code comments).
}
\examples{
\dontrun{
# Minimal toy example (two atoms connected by one bond)
atoms <- data.frame(
  eleno = c(1, 2),
  elena = c("C", "O"),
  x = c(0, 1), y = c(0, 0), z = c(0, 0)
)
bonds <- data.frame(origin = 1, target = 2)

plotrgl(
  atoms, bonds,
  col_atom_id = "eleno",
  col_atom_name = "elena",
  bond_width = 3,
  axes = TRUE, grid = TRUE,
  label_mode = "transparent"
)
}

}
\seealso{
prepare_atoms_for_plotting, enrich_bonds_with_xyz_position, to_interleaved
}
